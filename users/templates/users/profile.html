{% extends 'base.html' %}
{% block content %}
<div class="profile-container">
  <h2 class="text-center mb-4">My Profile</h2>
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-warning">{{ message }}</div>
    {% endfor %}
  {% endif %}

  <!-- Profile Completion -->
  <div class="progress-wrapper mb-4">
    <p class="mb-1"><strong>Completion: {{ completion }}%</strong></p>
    <div class="progress-bar">
      <div class="progress-fill" style="width: {{ completion }}%;"></div>
    </div>

    {% if not can_access_match %}
      <p class="hint-text mt-2 mb-0">Complete 80% to unlock matches!</p>
      <a href="{% url 'users:edit' %}" class="btn btn-warning btn-sm mt-2 d-block w-100">Complete Profile</a>
    {% else %}
      <p class="success-text mt-2 mb-0">Profile ready!</p>
      <a href="{% url 'matches:discover' %}" class="btn btn-success btn-sm mt-2 d-block w-100">Discover Matches</a>
    {% endif %}
  </div>

  <hr class="my-4">

  <!-- User Details -->
  <div class="user-details">
    <div class="row g-3">
      <div class="col-12 col-md-6">
        <p class="mb-1"><strong>Username:</strong> {{ user.username }}</p>
      </div>
      <div class="col-12 col-md-6">
        <p class="mb-1"><strong>Email:</strong> {{ user.email }}</p>
      </div>

      <div class="col-12">
        <p class="mb-1"><strong>Age:</strong>
          {% if user.dob %}
            {{ user.age }} years
          {% else %}
            <em class="text-muted">Not added</em>
          {% endif %}
        </p>
      </div>

      <div class="col-12">
        <p class="mb-1"><strong>City:</strong> {{ user.city|default:"<em class='text-muted'>Not added</em>"|safe }}</p>
      </div>

      <div class="col-12">
        <p class="mb-1"><strong>Bio:</strong></p>
        <p class="text-pre-wrap">{{ user.bio|default:"<em class='text-muted'>No bio yet</em>"|safe }}</p>
      </div>

      <div class="col-12">
        <p class="mb-1"><strong>Interests:</strong></p>
        <div class="d-flex flex-wrap gap-1">
          {% for interest in user.interests.all %}
            <span class="badge bg-secondary">{{ interest }}</span>
          {% empty %}
            <em class="text-muted">None</em>
          {% endfor %}
        </div>
      </div>

      {% if user.profile_photo %}
        <div class="col-12 text-center mt-3">
          <img src="{{ user.profile_photo.url }}" class="profile-img rounded shadow-sm" alt="Profile Photo">
        </div>
      {% endif %}
    </div>
  </div>

  <div class="text-center mt-4">
    <a href="{% url 'users:edit' %}" class="btn btn-outline-primary">Edit Profile</a>
  </div>
</div>

<style>
.profile-container {
  max-width: 680px;
  margin: 50px auto;
  background: #fff;
  padding: 30px;
  border-radius: 16px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.08);
  font-family: 'Poppins', sans-serif;
}
.progress-bar {
  height: 10px;
  background: #e9ecef;
  border-radius: 6px;
  overflow: hidden;
}
.progress-fill {
  background: #1e1e2f;
  height: 100%;
  border-radius: 6px;
  transition: width 0.6s ease;
}
.hint-text { color: #e67e22; font-weight: 500; }
.success-text { color: #27ae60; font-weight: 500; }
.btn-sm { padding: 10px 16px; font-size: 0.95rem; }
.text-pre-wrap { white-space: pre-wrap; }
.profile-img {
  width: 140px;
  height: 140px;
  object-fit: cover;
  border: 3px solid #fff;
}
.badge {
  font-size: 0.8rem;
  padding: 0.4em 0.7em;
}
@media (max-width: 576px) {
  .profile-container { margin: 20px auto; padding: 20px; }
}
</style>
{% endblock %}